# 자동 설정 만들기 2부 : @ConfigurationProperties

* 덮어쓰기 방지하기
  * @ConditionalOnMissingBean
* 빈 재정의 수고 덜기
  * @ConfigurationProperties(“holoman”)
  * @EnableConfigurationProperties(HolomanProperties)
  * 프로퍼티 키값 자동 완성

```xml
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-configuration-processor</artifactId>
	<optional>true</optional>
</dependency>
```



---

앞서 강의에서 발생했던 문제점을 해결해보자

### 자동 설정 파일 문제점

명시적으로 Holoman 빈을 등록하는 경우, 스프링부트 어플리케이션이 빈을 2단계로 등록하기 때문에,
먼저 `@ComponentScan`으로 우리가 작성한 빈등록 코드로 Holoman이 빈으로 등록된다. 그리고나서 `@EnableAutoConfiguration`로 읽어온 빈을 등록하려고 하기 때문에 (1)오버라이딩이 막혀있어 어플리케이션이 실행되지 않는다. (2)AutoConfiguration 설정으로 재정의 돼서 빈으로 등록되어 실행된다.



### 해결방법 1. @ComponentScan 이 무조건 우선시되도록 한다.

* 자동 설정 파일에 `@ConditionalOnMissingBean` 어노테이션 추가

`holoman` 빈이 존재하지 않는 경우에만 AutoConfiguration 설정에 따라 빈을 등록한다.

이미 ComponentScan으로 빈이 등록된 상황이라면 다시 빈을 만들지 않게 된다.

```java
@Configuration
public class HolomanConfiguration {

    @Bean
    @ConditionalOnMissingBean // <-- 어노테이션 추가
    public Holoman holoman() {
        Holoman holoman = new Holoman();
        holoman.setHowLong(5);
        holoman.setName("Solar");
        return holoman;
    }
}
```

위와 같이 코드를 수정 후, build → install (CLI : mvn install)



다시 실행해보면 명시적으로 등록한 빈의 설정값으로 잘 출력되는 것을 확인할 수 있다.

![image-20200901180013662](images/image-20200901180013662.png)



⇒ 스프링부트가 제공하는 여러가지 기본 설정(기능)들을 커스터마이징할 수 있는 기본 방법이다.



### 해결방법 2. 내가 굳이 `빈을 등록하는 코드`까지 써야할까? 빈의 설정 값만 변경하고 싶다.

빈을 재정의하는 수고를 덜어보자















