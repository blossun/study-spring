# 인덱스 핸들러 만들기

인덱스 핸들러

* 다른 리소스에 대한 링크 제공
* 문서화

```java
@GetMapping("/api")
    public ResourceSupport root() {
        ResourceSupport index = new ResourceSupport();
        index.add(linkTo(EventController.class).withRel("events"));
        return index;
    }

```

테스트 컨트롤러 리팩토링

* 중복 코드 제거

에러 리소스

* 인덱스로 가는 링크 제공

---

## 인덱스 핸들러

URL로 홈페이지에 접근한 후에는 그 다음 모든 행위들은 클릭(또는 값입력)으로 이루어진다.

ex) 유튜브 접속 후, 다음 영상을 보기위해 url을 입력하는 것이 아니라 터치로 화면이 전이 된다.

우리의 API에도 **진입점**이 필요하다. 진입점을 통해서 이벤트를 조회, 생성, 수정하는 일이 이뤄져야하기 때문에 진입점에 해당하는 index를 만들어야 한다.



### 테스트 코드 작성

확인사항

* index로 들어가면 각각의 리소스의 루트 링크를 제공

  현재 Event 리소스만 가지고 있으므로 Event에 해당하는 리소스의 루트를 제공

```java
@RunWith(SpringRunner.class)
@SpringBootTest
@AutoConfigureMockMvc
@AutoConfigureRestDocs
@Import(RestDocsConfiguration.class)
@ActiveProfiles("test")
public class IndexControllerTest {

    @Autowired
    MockMvc mockMvc;

    @Test
    public void index() throws Exception {
        this.mockMvc.perform(get("/api/"))
                .andExpect(status().isOk())
                .andExpect(jsonPath("_links.events").exists());
    }
}
```



### IndexController 구현

* 첫 페이지에 메뉴를 추가하는 것과 비슷한 구성이라고 생각하면 된다.

```java
@RestController
public class IndexController {

    @GetMapping("/api")
    public RepresentationModel index() {
        var index = new RepresentationModel();
        index.add(linkTo(EventController.class).withRel("events"));
        return index;
    }
}
```

※ var 자료구조 - JAVA 10

​	자바 10에 추가되었고 지역 변수에 한해서 타입을 지정하지 않고 var로 쓸 수 있다.



**※ Spring HATEOAS 변경사항**

* [Docs](https://docs.spring.io/spring-hateoas/docs/current/reference/html/#reference)

- `ResourceSupport` is now `RepresentationModel`
- `Resource` is now `EntityModel`
- `Resources` is now `CollectionModel`
- `PagedResources` is now `PagedModel`



### Error 페이지에서 활용

에러를 받은 후, 애플리케이션 상태를 전이할 수 있는 유일한 곳은 index이다. 따라서 에러 리소스에 인덱스로 가는 링크를 제공해주자







