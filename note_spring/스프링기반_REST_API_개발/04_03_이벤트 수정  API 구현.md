# Events 수정 API

테스트 할 것

> **수정하려는 이벤트가 없는 경우 404 NOT_FOUND**
>
> **입력 데이터 (데이터 바인딩)가 이상한 경우에 400 BAD_REQUEST**
>
> **도메인 로직으로 데이터 검증 실패하면 400 BAD_REQUEST**
>
> (권한이 충분하지 않은 경우에 403 FORBIDDEN)
>
> **정상적으로 수정한 경우에 이벤트 리소스 응답**
>
> * **200 OK**
> * **링크**
> * **수정한 이벤트 데이터**

---

## 4가지 경우에 대한 테스트 추가

```java
@Test
@TestDescription("이벤트를 정상적으로 수정하기")
public void updateEvent() throws Exception {
    // Given
    Event event = this.generateEvent(200);
    EventDto eventDto = this.modelMapper.map(event, EventDto.class);
    String eventName = "Update Event";
    eventDto.setName(eventName);

    // When & Then
    this.mockMvc.perform(put("/api/events/{id}", event.getId())
                    .contentType(MediaType.APPLICATION_JSON)
                    .content(this.objectMapper.writeValueAsString(eventDto))
                )
            .andDo(print())
            .andExpect(status().isOk())
            .andExpect(jsonPath("name").value(eventName))
            .andExpect(jsonPath("_links.self").exists());
}

@Test
@TestDescription("입력값이 비어있는 경우에 이벤트 수정 실패")
public void updateEvent400_Emtpy() throws Exception {
    // Given
    Event event = this.generateEvent(200);
    EventDto eventDto = this.modelMapper.map(event, EventDto.class);
    String eventName = "Update Event";
    eventDto.setName(eventName);

    // When & Then
    this.mockMvc.perform(put("/api/events/{id}", event.getId())
                    .contentType(MediaType.APPLICATION_JSON)
                    .content(this.objectMapper.writeValueAsString(eventDto)))
            .andDo(print())
            .andExpect(status().isBadRequest());
}

@Test
@TestDescription("입력값이 잘못된 경우에 이벤트 수정 실패")
public void updateEvent400_Wrong() throws Exception {
    // Given
    Event event = this.generateEvent(200);

    EventDto eventDto = this.modelMapper.map(event, EventDto.class);
    eventDto.setBasePrice(20000);
    eventDto.setMaxPrice(1000);

    // When & Then
    this.mockMvc.perform(put("/api/events/{id}", event.getId())
            .contentType(MediaType.APPLICATION_JSON)
            .content(this.objectMapper.writeValueAsString(eventDto)))
            .andDo(print())
            .andExpect(status().isBadRequest());
}

@Test
@TestDescription("존재하지 않는 이벤트 수정 실패")
public void updateEvent404() throws Exception {
    // Given
    Event event = this.generateEvent(200);
    EventDto eventDto = this.modelMapper.map(event, EventDto.class);

    // When & Then
    this.mockMvc.perform(put("/api/events/123123")
            .contentType(MediaType.APPLICATION_JSON)
            .content(this.objectMapper.writeValueAsString(eventDto)))
            .andDo(print())
            .andExpect(status().isNotFound());
}
```



















